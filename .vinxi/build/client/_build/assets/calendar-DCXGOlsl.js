import{j as s,K as M,a2 as F,H as N,a3 as Y,d as k,a4 as E,r as $,a5 as R,a6 as T,a7 as A,a8 as S}from"./client-Be5q_lbq.js";import{C as L,a as z}from"./chevron-left-s6Vrd-Kc.js";import{L as P}from"./layout-BdBLz4Bd.js";const Q=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],b=g=>`${g.getFullYear()}-${(g.getMonth()+1).toString().padStart(2,"0")}-${g.getDate().toString().padStart(2,"0")}`,W=({events:g,onCurrentDateChange:x,currentDate:c})=>{const f=()=>{const a=c.getFullYear(),t=c.getMonth(),r=new Date(a,t,1).getDay(),m=new Date(a,t+1,0).getDate(),i=[];let o=[];if(r>0){const e=t===0?11:t-1,n=t===0?a-1:a,d=new Date(n,e+1,0).getDate();for(let l=0;l<r;l++)o.push({date:new Date(n,e,d-r+1+l),isCurrentMonth:!1})}for(let e=1;e<=m;e++)o.push({date:new Date(a,t,e),isCurrentMonth:!0}),o.length===7&&(i.push(o),o=[]);if(o.length>0){const e=t===11?0:t+1,n=t===11?a+1:a;let d=1;for(;o.length<7;)o.push({date:new Date(n,e,d++),isCurrentMonth:!1});i.push(o)}return i},v=a=>{const t=b(a);return g.filter(r=>t>=r.date&&t<=r.dateEnd).sort((r,m)=>r.date.localeCompare(m.date))},w=a=>{const t=[];a.forEach((e,n)=>{v(e.date).forEach(l=>{const y=`${l.date}-${l.dateEnd}-${l.name}`,u=t.find(D=>D.key===y);u?(u.start=Math.min(u.start,n),u.end=Math.max(u.end,n)):t.push({event:l,start:n,end:n,key:y})})}),t.sort((e,n)=>e.start-n.start);const r=[],m=t.map(e=>{let n=-1;for(let d=0;d<r.length;d++)if(e.start>r[d].end){n=d,r[d].end=e.end;break}return n===-1&&(n=r.length,r.push({end:e.end})),{...e,slot:n}}),i=r.length,o=Array(a.length).fill(null).map(()=>Array(i).fill(null));return m.forEach(e=>{for(let n=e.start;n<=e.end;n++)o[n][e.slot]=e.event}),{weekCells:o,numSlots:i}},C=()=>{x(new Date(c.getFullYear(),c.getMonth()-1,1))},j=()=>{x(new Date(c.getFullYear(),c.getMonth()+1,1))},p=a=>{const t=new Date;return a.getDate()===t.getDate()&&a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()},h=()=>{x(new Date(new Date().setDate(1)))};return s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 border border-gray-200",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(M,{onClick:C,variant:"outline",size:"icon",className:"h-8 w-8",children:s.jsx(L,{className:"h-4 w-4"})}),s.jsx(M,{onClick:j,variant:"outline",size:"icon",className:"h-8 w-8",children:s.jsx(F,{className:"h-4 w-4"})})]}),s.jsx("h2",{className:"text-xl font-bold",children:c.toLocaleString("default",{month:"long",year:"numeric"})}),s.jsxs(M,{onClick:h,variant:"outline",size:"sm",className:"flex items-center gap-1",children:[s.jsx(z,{className:"h-4 w-4 mr-1"}),"Today"]})]}),s.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Q.map(a=>s.jsx("div",{className:"text-center font-medium text-gray-500 text-sm py-2",children:a},a)),f().map((a,t)=>{const{weekCells:r,numSlots:m}=w(a);return a.map((i,o)=>{const e=p(i.date);return s.jsxs("div",{className:N("border rounded min-h-[6rem] flex flex-col p-1 relative transition-colors",i.isCurrentMonth?"bg-white":"bg-gray-50 text-gray-400",e&&"ring-2 ring-primary ring-offset-1","hover:bg-gray-50"),children:[s.jsx("span",{className:N("text-sm font-medium h-6 w-6 flex items-center justify-center rounded-full",e&&"bg-primary text-primary-foreground"),children:i.date.getDate()}),s.jsx("div",{className:"flex flex-col gap-1 mt-1 w-full",children:Array.from({length:m}).map((n,d)=>{const l=r[o][d];if(l){const y=b(i.date),u=y===l.date,D=y===l.dateEnd;return s.jsx("div",{className:N("w-full h-5 relative overflow-hidden",Y(l.name),u?"rounded-l-md":"",D?"rounded-r-md":"","shadow-sm hover:opacity-90 cursor-pointer"),title:l.name,children:s.jsx("span",{className:"absolute inset-0 flex items-center justify-start text-white text-xs px-1 truncate",children:l.name})},d)}return s.jsx("div",{className:"w-full h-5"},d)})})]},`${t}-${o}`)})})]})]})},O=function(){const x=k(),{date:c}=E.useSearch(),f=new Date(c||Date.now()),v=p=>{x({from:E.fullPath,search:{date:S(p)}})},{firstSunday:w,lastSaturday:C}=$.useMemo(()=>R(f.getFullYear(),f.getMonth()+1),[f]),{data:j}=T({...A.list({startDate:S(w)}),select:p=>p.filter(h=>h.date).map(h=>({...h,date:h.date,dateEnd:h.dateEnd??h.date}))});return s.jsx(P,{children:s.jsx(W,{events:j??[],currentDate:f,onCurrentDateChange:v})})};export{O as component};

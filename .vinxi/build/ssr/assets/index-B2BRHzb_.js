import{jsx as e,jsxs as r,Fragment as A}from"react/jsx-runtime";import{getRouteApi as j,useNavigate as G,ErrorComponent as P}from"@tanstack/react-router";import*as N from"react";import z,{useState as _,useEffect as R}from"react";import{ErrorBoundary as E}from"react-error-boundary";import{C as F,a as L,d as B,e as Q,b as J,c as K}from"./card-3I0Ckeqd.js";import{c as i,j as b,i as W,k as S,t as Y,B as w,S as Z,E as ee,l as I}from"./ssr-BorI3jCH.js";import{useSuspenseQuery as q}from"@tanstack/react-query";import{cva as ae}from"class-variance-authority";import{format as te}from"date-fns";import{ChevronDown as re,ChevronRight as ne,ChevronLeft as se,FilterIcon as oe,X as O,CalendarIcon as le}from"lucide-react";import*as u from"@radix-ui/react-accordion";import{DayPicker as ie}from"react-day-picker";import{L as f,I as ce}from"./input-VBkQFdq7.js";import*as v from"@radix-ui/react-popover";import*as V from"@radix-ui/react-separator";import{L as de}from"./layout-DeG64cWT.js";import"@tanstack/react-router-with-query";import"sonner";import"zod";import"zod-validation-error";import"@radix-ui/react-icons";import"better-auth/react";import"@tanstack/router-core";import"node:async_hooks";import"h3";import"@radix-ui/react-slot";import"clsx";import"tailwind-merge";import"@radix-ui/react-navigation-menu";import"@radix-ui/react-avatar";import"@radix-ui/react-dropdown-menu";import"@radix-ui/react-switch";import"node:stream";import"react-dom/server";import"node:stream/web";import"@radix-ui/react-label";function g({className:a,...t}){return e("div",{className:i("animate-pulse rounded-md bg-muted",a),...t})}const me=()=>{const[a,t]=_(0);return R(()=>{t(Math.floor(Math.random()*6)+2)},[]),r(F,{children:[r(L,{children:[e(g,{className:"h-8 w-44"}),e(g,{className:"h-5 w-20"})]}),r(B,{children:[e("h3",{className:"mb-2",children:e(g,{className:"h-6 w-28"})}),e("ul",{className:"flex gap-1 flex-wrap",children:Array.from({length:a}).map((n,s)=>e("li",{children:e(g,{className:"h-8 w-8 rounded-full"})},s))})]}),e(Q,{children:e(g,{className:"h-8 w-32"})})]})},ue=ae("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:t,...n}){return e("div",{className:i(ue({variant:t}),a),...n})}const pe=({event:a})=>{const{tags:t=[]}=j("/").useSearch();return r(F,{children:[r(L,{children:[e(J,{children:a.eventUrl?e("a",{href:a.eventUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:a.name}):a.name}),e(K,{children:a.date?r(A,{children:[b(new Date(a.date)),a.dateEnd&&" - ",a.dateEnd?b(new Date(a.dateEnd)):null]}):null})]}),r(B,{children:[e("p",{children:a.city&&a.country&&`${a.city}, ${a.country}`}),a.cfpUrl&&e("p",{children:r("a",{href:a.cfpUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:["Call for Paper"," ",a.cfpClosingDate?r("span",{className:new Date(a.cfpClosingDate)<new Date?"text-red-500":"text-green-500",children:["(",a.cfpClosingDate,")"]}):null]})})]}),e(Q,{children:e("div",{className:"flex gap-1",children:a.tags?.map(n=>e(h,{variant:t.includes(n)?"default":"outline",className:"capitalize",children:n},n))})})]})},he=()=>{const a=j("/").useSearch();return q(W.list(a)).data.map(n=>e(pe,{event:n},n.id))},T=u.Root,C=N.forwardRef(({className:a,...t},n)=>e(u.Item,{ref:n,className:i("border-b",a),...t}));C.displayName="AccordionItem";const D=N.forwardRef(({className:a,children:t,...n},s)=>e(u.Header,{className:"flex",children:r(u.Trigger,{ref:s,className:i("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...n,children:[t,e(re,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));D.displayName=u.Trigger.displayName;const k=N.forwardRef(({className:a,children:t,...n},s)=>e(u.Content,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:e("div",{className:i("pb-4 pt-0",a),children:t})}));k.displayName=u.Content.displayName;function M({className:a,classNames:t,showOutsideDays:n=!0,...s}){return e(ie,{showOutsideDays:n,className:i("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:i(S({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:i(S({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({className:o,...c})=>e(se,{className:i("h-4 w-4",o),...c}),IconRight:({className:o,...c})=>e(ne,{className:i("h-4 w-4",o),...c})},...s})}M.displayName="Calendar";const fe=v.Root,ge=v.Trigger,U=N.forwardRef(({className:a,align:t="center",sideOffset:n=4,...s},o)=>e(v.Portal,{children:e(v.Content,{ref:o,align:t,sideOffset:n,className:i("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",a),...s})}));U.displayName=v.Content.displayName;const H=N.forwardRef(({className:a,orientation:t="horizontal",decorative:n=!0,...s},o)=>e(V.Root,{ref:o,decorative:n,orientation:t,className:i("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",a),...s}));H.displayName=V.Root.displayName;const ye=({selectedTags:a,onToggleTag:t})=>{const{data:n}=q(Y.list());return e(A,{children:n.map(s=>e(h,{className:"cursor-pointer capitalize",onClick:()=>t(s),variant:a.includes(s)?"default":"outline",children:s},s))})},ve=(a,t=200)=>{const[n,s]=_(a);return R(()=>{const o=setTimeout(()=>{s(a)},t);return()=>{clearTimeout(o)}},[a,t]),n},Ne=(a,t)=>{const[n,s]=_(a.query??""),o=(d,l)=>{const x=a[d]??[],$=x.includes(l)?x.filter(X=>X!==l):[...x,l];t({...a,[d]:$})},c=d=>{t({...a,[d]:a[d]?void 0:!0})},m=(d,l)=>{t({...a,[d]:l})},p=ve(n);return R(()=>{m("query",p)},[p]),{query:n,setQuery:s,setFilter:m,toggleArrayItem:o,toggleBooleanItem:c,filters:a}},xe=({filters:a,onSetFilters:t})=>{const{query:n,setQuery:s,toggleArrayItem:o,toggleBooleanItem:c,setFilter:m}=Ne(a,t),p=[!!a.query,!!a.hasCfpOpen,!!a.startDate,(a.modes?.length||0)>0,(a.tags?.length||0)>0].filter(Boolean).length,d=()=>{t({}),s("")};return e(F,{className:"p-4 mb-6 shadow-sm",children:e(T,{type:"single",collapsible:!0,defaultValue:"filters",className:"w-full",children:r(C,{value:"filters",className:"border-none",children:[e(D,{className:"py-0 hover:no-underline",children:r("div",{className:"flex items-center justify-between w-full",children:[r("div",{className:"flex items-center gap-2 py-1",children:[e(oe,{className:"h-5 w-5 text-primary"}),e("h2",{className:"text-lg font-medium",children:"Event Filters"}),p>0&&e(h,{variant:"secondary",children:p})]}),p>0&&r(w,{size:"sm",variant:"ghost",onClick:l=>{l.preventDefault(),d()},className:"flex items-center gap-1",children:[e(O,{className:"h-4 w-4"}),e("span",{children:"Clear all"})]})]})}),r(k,{className:"pt-4",children:[r("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[r("div",{className:"space-y-2",children:[r("div",{className:"flex items-end justify-between",children:[e(f,{htmlFor:"event-name",className:"font-medium",children:"Name"}),a.query&&e(y,{onClick:()=>{s(""),m("query",void 0)}})]}),e(ce,{id:"event-name",placeholder:"Search events by name...",value:n,onChange:l=>s(l.target.value),className:"w-full"})]}),r("div",{className:"space-y-2",children:[r("div",{className:"flex items-end justify-between",children:[e(f,{htmlFor:"cfp-open-switch",className:"font-medium",children:"CFP Status"}),a.hasCfpOpen&&e(y,{onClick:()=>c("hasCfpOpen")})]}),r("div",{className:"flex items-center gap-2 h-10 px-3 rounded-md border border-input bg-background",children:[e(Z,{id:"cfp-open-switch",checked:!!a.hasCfpOpen,onCheckedChange:()=>c("hasCfpOpen")}),e("span",{className:"text-sm text-muted-foreground",children:a.hasCfpOpen?"Only showing events with open CFPs":"All events"})]})]}),r("div",{className:"space-y-2",children:[r("div",{className:"flex items-end justify-between",children:[e(f,{htmlFor:"start-date",className:"font-medium",children:"Start Date"}),a.startDate&&e(y,{onClick:()=>m("startDate",void 0)})]}),r(fe,{children:[e(ge,{asChild:!0,children:r(w,{id:"start-date",variant:"outline",className:"w-full justify-start text-left font-normal",children:[e(le,{className:"mr-2 h-4 w-4"}),a.startDate?te(new Date(a.startDate),"PPP"):e("span",{className:"text-muted-foreground",children:"Pick a date"})]})}),e(U,{className:"w-auto p-0",align:"start",children:e(M,{mode:"single",selected:a.startDate?new Date(a.startDate):void 0,onSelect:l=>m("startDate",l?b(l):void 0),initialFocus:!0})})]})]})]}),e(H,{className:"my-4"}),e(T,{type:"single",collapsible:!0,defaultValue:"item-1",className:"w-full",children:r(C,{value:"item-1",className:"border-none",children:[e(D,{className:"py-2",children:r("div",{className:"flex items-center gap-2",children:[e("span",{children:"Additional Filters"}),(a.modes?.length||0)+(a.tags?.length||0)>0&&e(h,{variant:"secondary",children:(a.modes?.length||0)+(a.tags?.length||0)})]})}),r(k,{className:"space-y-4 py-2",children:[r("div",{className:"space-y-2",children:[r("div",{className:"flex items-center justify-between",children:[e(f,{className:"font-medium",children:"Event Mode"}),(a.modes?.length||0)>0&&e(y,{onClick:()=>m("modes",void 0)})]}),e("div",{className:"flex flex-wrap gap-2",children:ee.map(l=>e(h,{className:"cursor-pointer",onClick:()=>o("modes",l),variant:a.modes?.includes(l)?"default":"outline",children:l},l))})]}),r("div",{className:"space-y-2",children:[r("div",{className:"flex items-center justify-between",children:[e(f,{className:"font-medium",children:"Tags"}),(a.tags?.length||0)>0&&e(y,{onClick:()=>m("tags",void 0)})]}),e("div",{className:"flex flex-wrap gap-2",children:e(z.Suspense,{fallback:e(h,{variant:"outline",children:"Loading tags..."}),children:e(ye,{selectedTags:a.tags??[],onToggleTag:l=>o("tags",l)})})})]})]})]})})]})]})})})};function y({onClick:a}){return e(w,{size:"sm",variant:"ghost",className:"h-5 px-2 -mb-2",onClick:a,children:e(O,{className:"h-3 w-3"})})}const be=Array.from({length:2}),aa=function(){const t=I.useSearch(),n=G();return r(de,{children:[r("div",{className:"mb-9 text-center",children:[e("h1",{className:"text-4xl font-bold tracking-tight mb-3",children:"Tech Events & Conferences"}),e("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Discover the best tech conferences, meetups, and workshops happening around the world."})]}),r("div",{className:"flex flex-col gap-4 w-full",children:[e(E,{fallbackRender:o=>e(P,{error:o.error}),children:e(xe,{filters:t,onSetFilters:o=>{n({from:I.fullPath,search:o})}})}),e("div",{className:"flex flex-col gap-4",children:e(E,{fallbackRender:o=>e(P,{error:o.error}),children:e(z.Suspense,{fallback:be.map((o,c)=>e(me,{},c)),children:e(he,{})})})})]})]})};export{aa as component};
